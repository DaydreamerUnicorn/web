---
templateKey: blog
path: '/securing-flask-application-using-kratos-and-keto/'
author: gen1us2k
title: Securing Your Flask Application Using Kratos and Keto
teaser: Securing your flask application with open source solutions
subtitle: Let's build a flask application using Ory Kratos and Ory Keto
overline: Flask authentication guide
publishedAt: 2022-02-01
published: true
description: ''
tags:
  - Guide
  - Authentication
  - Ory Cloud
  - Open Source
  - User Management
---
import CodeFromRemote from '../../components/freestanding/utils/codefromremote'

Using Ory Cloud with Django Framework.

One can build a web application with Python programming language, and there are several options for choosing a web framework. We have at least two frameworks such as Django and Flask. In the previous blog post, we discussed how to secure a web application using Ory Kratos. Let's do the same thing for Django.

Django is a web framework for perfectionists with deadlines and can help build web applications quickly. It has its authentication and permissions framework, admin interface, and a lot of integrations with popular relational database systems such as PostgreSQL, Percona Server, SQLite, MySQL, and MariaDB.

I love building web apps using Django because it was my first web framework, and I love its ecosystem.

In this tutorial, we'll build a simple one-page application with authentication covered by Ory Cloud. Let's start hacking, huh?

## Bootstrapping Django project

Django has many ways to bootstrap a project:

1. Django cookiecutter is a framework for jumpstarting production-ready Django apps. It's a useful framework generating everything you need for the Django project, including docker support, integration with Cloud storage such as S3, and many more.
2. `django-admin` command. We'll use it because we want to build something simple, and it would be easier for local development.

It would be best if you had poetry installed because it's the primary tool for managing dependencies for this tutorial.

```bash
mkdir django-ory-cloud
cd django-ory-cloud
poetry init

This command will guide you through creating your pyproject.toml config.

Package name [django-ory-cloud]:
Version [0.1.0]:
Description []:  An example django application with Ory Cloud as an Authentication backend
Author [Andrew Minkin <minkin.andrew@gmail.com>, n to skip]:
License []:
Compatible Python versions [^3.10]:

Would you like to define your main dependencies interactively? (yes/no) [yes] no
Would you like to define your development dependencies interactively? (yes/no) [yes] no
Generated file

[tool.poetry]
name = "django-ory-cloud"
version = "0.1.0"
description = "An example django application with Ory Cloud as an Authentication backend"
authors = ["Andrew Minkin <minkin.andrew@gmail.com>"]

[tool.poetry.dependencies]
python = "^3.10"

[tool.poetry.dev-dependencies]

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"


Do you confirm generation? (yes/no) [yes] yes
```

Installing Django

```
 poetry add Django
Creating virtualenv django-ory-cloud-0UeuvAWs-py3.10 in /Users/gen1us2k/Library/Caches/pypoetry/virtualenvs
Using version ^4.0.4 for Django

Updating dependencies
Resolving dependencies... (1.0s)

Writing lock file

Package operations: 3 installs, 0 updates, 0 removals

  • Installing asgiref (3.5.1)
  • Installing sqlparse (0.4.2)
  • Installing django (4.0.4)
```

Creating project

```
poetry run django-admin startproject mysite
```

It generates the following project structure

```
.
├── mysite
│   ├── manage.py
│   └── mysite
│       ├── __init__.py
│       ├── asgi.py
│       ├── settings.py
│       ├── urls.py
│       └── wsgi.py
├── poetry.lock
└── pyproject.toml

2 directories, 8 files

```

```
poetry add django-environ django-ory-auth
Using version ^0.8.1 for django-environ
Using version ^0.1.3 for django-ory-auth

Updating dependencies
Resolving dependencies... (2.4s)

Writing lock file

Package operations: 7 installs, 0 updates, 0 removals

  • Installing certifi (2021.10.8)
  • Installing charset-normalizer (2.0.12)
  • Installing idna (3.3)
  • Installing urllib3 (1.26.9)
  • Installing requests (2.27.1)
  • Installing django-environ (0.8.1)
  • Installing django-ory-auth (0.1.3)

poetry shell
cd mysite

```

## Configuring django project for Ory Cloud

On the previous step we installed django-ory-auth package. Let's configure it.

we need to add it to the INSTALLED_APPS

```
# Application definition

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'django_ory_auth',
]

```

The package comes with context processors and a couple of middlewares.
Since Ory cloud has its authentication mechanisms you need to replace authentication backends with `django_ory_auth.backend.OryBackend`

```
AUTHENTICATION_BACKENDS = [
    "django_ory_auth.backend.OryBackend",
]
```

Templates

import `os` package at the beginning of the file

```
TEMPLATES
...
        'DIRS': [os.path.join(BASE_DIR, 'templates')],
...
```


## Creating the Ory Cloud project

## Installing Ory Cli

## Testing everything together


